{% extends 'bases/base_sin_sidebar.html' %}
{% load static %}
{% load humanize %}

{% block title %}
    Lista de Pacientes
{% endblock %}

{% block sidebar %}
<div class="sidebar" data-color="purple" data-background-color="white" data-image="/static/assets/img/sidebar-1.jpg">
  <div class="logo">
    <a target="_blank" rel="noopener noreferrer" class="simple-text logo-normal">
      Control <i class="fa fa-ravelry fa-lg text-info" aria-hidden="true"></i> Dr. Ortega
   </a>
  </div>
  <div class="sidebar-wrapper">
    <ul class="nav">
    {% if request.user.is_authenticated %}

      <li class="nav-item ">
        <a class="nav-link" href="{% url 'dashboard' %}">
          <i class="material-icons">dashboard</i>
          <p>Menú Principal</p>
        </a>
      </li>
      <li class="nav-item">
          <a class="nav-link" href="/">
            <i class="material-icons">public</i>
            <p>Website</p>
          </a>
      </li>
      <li class="nav-item active {% if 'page-user' in segment %} active {% endif %}">
        <a class="nav-link" href="{% url 'class_pacientes_lista' %}">
          <i class="material-icons">medical_services</i>
          <p>Pacientes</p>
        </a>
      </li>
      <li class="nav-item {% if 'ui-tables' in segment %} active {% endif %}">
        <a class="nav-link" href="{% url 'class_staff_lista' %}">
          <i class="material-icons">groups</i>
          <p>Staff</p>
        </a>
      </li>
      <li class="nav-item {% if 'ui-typography' in segment %} active {% endif %}">
        <a class="nav-link" href="{% url 'class_detail_staff' user.staff.id %}">
          <i class="material-icons">person</i>
          <p>Perfíl de Usuario</p>
        </a>
      </li>
      <li class="nav-item {% if 'ui-typography' in segment %} active {% endif %}">
        <a class="nav-link" href="{% url 'admin:login' %}">
          <i class="material-icons">admin_panel_settings</i>
          <p>Modo Admin</p>
        </a>
      </li>       

      <li class="nav-item ">
        <a class="nav-link" href="{% url 'logout' %}" >
          <i class="material-icons">directions_run</i>
          <p>Salir</p>
        </a>
      </li>

     
    {% else %}

    <li class="nav-item active ">
      <a class="nav-link" href="{% url 'login' %}" >
        <i class="material-icons">face</i>
        <p>Entrar</p>
      </a>
    </li>


    {% endif %}
    </ul>
  </div>

</div>
{% endblock %}

{% block content %}

{% for message in messages %}
<!-- Success Alert Content -->
<div class="alert alert-success alert-dismissable">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <h4><i class="fa fa-check-circle"></i> Éxito</h4> <a href="javascript:void(0)" class="alert-link">{{ message }}</a>!
</div>
    <!-- END Success Alert Content -->
{% endfor %}

  <div class="container">
  <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header card-header-primary">          
              <h3 class="card-title ">Lista de Pacientes</h3>            
          </div>
          <div class="card-body">
            {% if pacientes %}
            <div class="table-responsive table-striped">
              <table class="table table-hover">
                <thead class="text-primary">
                  <tr>
                    <strong>
                      <th class="text-center "><h4>ID</h4></th>
                      <th class="text-center "><h4>Apellido Paterno</h4></th>
                      <th class="text-center "><h4>Apellido Materno</h4></th>
                      <th class="text-center "><h4>Nombre (s)</h4></th>
                      <th class="text-center "><h4>Función</h4></th>
                    </strong>
                  </tr>
              </thead>
              <tbody>
                  {% for paciente in pacientes %}
                  <tr>
                      <td class="text-center"><strong><p>{{paciente.id_Expediente}}</p></strong></td>
                      <td class="text-center"><p>{{paciente.Apellido_Paterno}}</p></td>
                      <td class="text-center"><p>{{paciente.Apellido_Materno}}</p></td>
                      <td class="text-center"><p>{{paciente.Nombre}}</p></td>
                      <td class="text-center">
                          <div class="btn-group btn-group-md">
                              <a href="{% url 'class_detail_paciente' paciente.id %}" title="Datos personales, galería, consultas y citas" class="btn mr-2"><i class="fa fa-folder-open"></i></a>
                              <a href="{% url 'class_delete_record' paciente.id %}" data-toggle="tooltip" title="¿Eliminar registro y sus datos?" class="btn btn-danger"><i class="fa fa-times"></i></a>
                          </div>
                      </td>
                  </tr>
                  {% endfor %}
              </tbody>
              </table>              
            </div>
            {% else %}
              <center>
                <h3>no se han encontrado pacientes...</h3>
                <img src="{% static 'assets/img/new_logo.png' %}" alt="" style="width:30%;">
              </center>
            {% endif %}

            <div class="row">
              <div class="container offset-xl-4 ">
               <h4>  
                <ul class="pagination">
                          {% if pacientes %}              
                            {% if pacientes.has_other_pages %}
                               
                                  {% if pacientes.has_previous %}                                 
                                      <li><a href="?page={{ pacientes.previous_page_number }}"><i class="fa fa-chevron-left" aria-hidden="true"></i></a></li>                                 
                                  {% else %}
                                      <li class="disabled"><span><i class="fa fa-chevron-left" aria-hidden="true"></i></span></li>
                                  {% endif %}
                                  {% if page_obj.number|add:'-4' > 1 %}
                                      <li><a href="?page={{ pacientes.number|add:'-5' }}">&hellip;</a></li>
                                  {% endif %}
                                



                                  {% for i in pacientes.paginator.page_range %}
                                     {% if pacientes.number == i %}
                                        <li class=" badge "><span>{{ i }} <span class="sr-only">(current)</span></span></li>
                                     {% elif i > pacientes.number|add:'-5' and i < pacientes.number|add:'5' %}
                                        <li class="waves-effect mr-1" ><a href="?page={{ i }}">{{ i }}</a></li>
                                     {% endif %}
                                  {% endfor %}

                                  {% if pacientes.paginator.num_pages > pacientes.number|add:'4' %}
                                      <li><a href="?page={{ pacientes.number|add:'5' }}">&hellip;</a></li>
                                  {% endif %}

                                  {% if pacientes.has_next %}
                                      <li><a href="?page={{ pacientes.next_page_number }}"><i class="fa fa-chevron-right" aria-hidden="true"></i></a></li>
                                  {% else %}
                                      <li class="disabled"><span><i class="fa fa-chevron-right" aria-hidden="true"></i></span></li>
                                  {% endif %} 
                               

                            {% endif %}
                         {% endif %}
                </ul>
             </h4>
            </div>
          </div>

            <div class="card card-footer">             
                <h4>
                  <strong>Pacientes</strong> Total: <span class="text-danger">{{contador|intcomma}}</span>
                </h4>              
            </div>



          </div>
        </div>
      </div>
  </div>
</div>

  {% endblock %}

  {% block footer %}
  {% endblock %}
